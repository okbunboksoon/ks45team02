<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="ks45team02.ire.admin.mapper.GoodsMapper">
	<resultMap id="GoodsResultMap" type="Goods">
		<id property="goodsCode" 					column="goods_code" />
		<result property="goodsName" 				column="goods_name"/>
		<result property="categoryMediumNum"		column="category_medium_num"/>
		<result property="categoryMediumName"		column="category_medium_name"/>
		<result property="goodsPrice" 				column="goods_price"/>
		<result property="goodsColor" 				column="goods_color"/>
		<result property="goodsSize" 				column="goods_size"/>
		<result property="goodsRegDate" 			column="goods_reg_date"/>
		<result property="goodsSangse" 			column="goods_sangse"/>
		<result property="goodsImage" 				column="goods_image"/>
		<result property="fabric" 					column="fabric"/>
		<result property="rate" 					column="rate"/>
		<result property="upcyclingCarbonDioxideEmissionLevel" column="upcycling_carbon_dioxide_emission_level"/>
	</resultMap>
	
	<select id="goodsCheck" parameterType="String" resultType="int">
		<!-- 상품코드로 상품 존재여부 확인 -->
		SELECT 
			COUNT(1)
		FROM 
			goods 
		WHERE 
			goods_code = #{goodsCode};
	</select>
	
	<select id="searchGoods" resultMap="GoodsResultMap" parameterType="String">
		<!-- 상품 검색 -->
		SELECT 
			 g.goods_code
			,g.goods_name
			,cm.category_medium_name
			,g.goods_price
			,g.goods_color
			,g.goods_size
		FROM 
			goods AS g
			INNER JOIN 
			category_medium AS cm
			ON  
			g.category_medium_code = cm.category_medium_code
		<where>
			<if test="searchKey != null and searchKey != '' and searchValue != null and searchValue != ''">
				${searchKey} LIKE CONCAT('%', #{searchValue}, '%')
			</if>
		</where>
	</select>
	
	<select id="getListGoods" resultMap="GoodsResultMap">
		SELECT
			g.goods_code
			,g.goods_name
			,g.category_medium_num
			,g.goods_price
			,g.goods_color
			,g.goods_size
			,g.goods_reg_date
			,g.goods_sangse
			,g.goods_image
			,g.fabric
			,g.rate
			,g.upcycling_carbon_dioxide_emission_level	
		FROM
			goods AS g
	</select>
</mapper>